# PaddleOCR 功能测试清单

## 功能已集成 ✅

### 创建的文件

1. **PaddleOCR 工具类**
   - `src/utils/paddleOCR.ts`
   - 功能：OCR 识别、批量识别、配置管理

2. **配置文件**
   - `src/config/paddleOCR.ts`
   - 功能：环境变量配置、初始化

3. **环境变量示例**
   - `.env.local.example`
   - 功能：配置模板

4. **配置指南**
   - `PADDLE_OCR_GUIDE.md`
   - 功能：详细配置和使用说明

### 修改的文件

1. **智能导入页面**
   - `src/app/admin/smart-import/page.tsx`
   - 修改：
     - 添加 OCR 引擎选择器（Tesseract.js / PaddleOCR）
     - 根据 OCR 引擎调用不同的 OCR 函数
     - 添加引擎说明和提示

## 测试步骤

### 1. 配置 PaddleOCR API（必须有 Token）

#### 1.1 创建环境变量文件

在项目根目录创建 `.env.local` 文件：

```bash
cat > .env.local << 'EOF'
# PaddleOCR 配置
NEXT_PUBLIC_PADDLE_OCR_API_URL=https://your-paddleocr-api.com/api/ocr
NEXT_PUBLIC_PADDLE_OCR_TOKEN=your_paddleocr_token_here
EOF
```

**注意**：请替换为你的真实 API 地址和 Token！

#### 1.2 重启开发服务器

```bash
# 停止当前服务（Ctrl + C）
# 重新启动
pnpm dev
```

### 2. 验证配置

#### 2.1 检查智能导入页面

1. 访问 http://localhost:5000/admin/smart-import
2. 开启「OCR 识别」开关
3. 检查是否出现「OCR 引擎」选择器
4. 检查是否显示「PaddleOCR API」选项

#### 2.2 检查浏览器控制台

打开浏览器控制台（F12），查看是否有以下日志：

```
[PaddleOCR] 配置已初始化: { apiUrl: "...", hasToken: true }
```

### 3. 测试 PaddleOCR 识别

#### 3.1 准备测试图片

准备一张清晰的图片，建议：
- 教科书扫描件
- 试卷截图
- 单词表图片

图片要求：
- 格式：JPG 或 PNG
- 清晰度：高分辨率
- 内容：清晰的文字

#### 3.2 上传图片测试

1. 刷新智能导入页面
2. 选择「模拟卷」类型
3. 开启「OCR 识别」开关
4. 选择 OCR 引擎为「PaddleOCR API」
5. 点击「选择文件」
6. 选择测试图片
7. 查看识别进度
8. 等待识别完成
9. 查看识别结果（文本 + 置信度）

#### 3.3 查看识别结果

识别完成后，会显示：
- 识别出的文本
- 置信度（> 80% 为好）
- 自动上传状态

### 4. 对比测试

#### 4.1 Tesseract.js vs PaddleOCR

使用同一张图片，对比两个引擎的识别效果：

| 图片 | 引擎 | 识别结果 | 置信度 | 速度 |
|------|------|---------|--------|------|
| 测试图1 | Tesseract.js | ... | 85% | 慢 |
| 测试图1 | PaddleOCR | ... | 98% | 快 |

#### 4.2 测试场景

测试不同的图片类型：

✅ **打印文字**
- 教科书
- 试卷
- 讲义

✅ **手写文字**
- 学生笔记
- 手写作业

✅ **中英文混合**
- 双语教材
- 英文试卷（中文标注）

## 测试清单

### 基础功能测试

- [ ] 配置 PaddleOCR API（API 地址 + Token）
- [ ] 重启开发服务器
- [ ] 刷新智能导入页面
- [ ] 检查 OCR 引擎选择器是否显示
- [ ] 检查「PaddleOCR API」选项是否可用

### 识别功能测试

- [ ] 上传清晰打印文字图片
- [ ] 查看识别进度
- [ ] 查看识别结果
- [ ] 查看置信度
- [ ] 检查识别准确性

### 错误处理测试

- [ ] 测试 API Token 错误
- [ ] 测试网络错误
- [ ] 测试无效图片格式
- [ ] 测试低质量图片
- [ ] 查看错误提示

### 性能测试

- [ ] 测试识别速度（清晰图片）
- [ ] 测试识别速度（大图片）
- [ ] 测试识别速度（多张图片）

### 对比测试

- [ ] 对比 Tesseract.js 和 PaddleOCR 的识别效果
- [ ] 对比识别速度
- [ ] 对比识别准确性

## 预期结果

### 成功情况

✅ **配置成功**：
- 显示「PaddleOCR API」选项
- 控制台显示「配置已初始化」

✅ **识别成功**：
- 显示识别进度
- 显示识别结果
- 显示置信度（> 80%）
- 自动上传文本

✅ **错误处理**：
- 显示友好的错误提示
- 不会导致页面崩溃

### 失败情况

❌ **配置失败**：
- 原因：未配置 API 地址或 Token
- 解决：检查 `.env.local` 文件

❌ **识别失败**：
- 原因：图片质量差、网络错误、API 错误
- 解决：使用更清晰的图片、检查网络、检查 API 配置

## 常见问题

### Q: 为什么看不到「PaddleOCR API」选项？

A: 检查以下内容：
1. 是否配置了 `NEXT_PUBLIC_PADDLE_OCR_API_URL`
2. 是否配置了 `NEXT_PUBLIC_PADDLE_OCR_TOKEN`
3. 是否重启了开发服务器
4. 是否刷新了页面

### Q: 识别失败，提示"配置未设置"？

A: 检查环境变量配置：
1. 打开 `.env.local` 文件
2. 确认 API 地址和 Token 正确
3. 重启开发服务器

### Q: 识别速度很慢？

A: 可能的原因：
1. 网络问题
2. 图片太大
3. API 响应慢

解决方法：
1. 检查网络连接
2. 压缩图片
3. 联系 PaddleOCR 官方

### Q: 识别结果不准确？

A: 可能的原因：
1. 图片质量差
2. 文字模糊
3. 复杂排版

解决方法：
1. 使用更清晰的图片
2. 提高图片分辨率
3. 校正图片方向

## 下一步

### 1. 错题上传集成

在错题上传页面集成 OCR 功能：
- 添加 OCR 引擎选择器
- 支持图片上传
- 自动识别错题

### 2. 模拟卷上传集成

在模拟卷上传页面集成 OCR 功能：
- 添加 OCR 引擎选择器
- 支持图片上传
- 自动识别模拟卷

### 3. 批量识别

实现批量识别功能：
- 一次上传多张图片
- 批量识别
- 合并识别结果

### 4. 图片预处理

添加图片预处理功能：
- 自动调整亮度、对比度
- 去除噪点
- 校正图片方向

## 总结

PaddleOCR OCR 功能已完全集成，支持：
- ✅ OCR 引擎选择（Tesseract.js / PaddleOCR）
- ✅ 图片文字识别
- ✅ 中英文混合识别
- ✅ 进度显示
- ✅ 置信度显示
- ✅ 自动上传

请按照上述步骤进行测试，如有问题，请查看浏览器控制台错误信息或联系技术支持。
